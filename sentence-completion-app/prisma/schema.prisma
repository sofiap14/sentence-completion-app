datasource db {
  provider = "postgresql" // or your chosen database provider
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id             Int         @id @default(autoincrement())
  email          String      @unique
  password       String
  progress       Progress[]  @relation("UserProgress") // Updated to handle progress separately
  responses      Response[]  @relation("UserResponses")
}

model Progress {
  id             Int         @id @default(autoincrement())
  userId         Int         @unique
  currentWeek    Int         @default(1)  // The current week user is working on
  submissions    Int         @default(0)  // Number of days submitted in the current week
  user           User        @relation("UserProgress", fields: [userId], references: [id])
}

model SentenceStem {
  id         Int         @id @default(autoincrement())
  text       String
  weekNumber Int
  order      Int
  responses  Response[]  @relation("StemResponses")
}

model Response {
  id             Int          @id @default(autoincrement())
  responseText   String
  createdAt      DateTime     @default(now())
  userId         Int
  sentenceStemId Int

  user           User         @relation("UserResponses", fields: [userId], references: [id])
  sentenceStem   SentenceStem @relation("StemResponses", fields: [sentenceStemId], references: [id])

  @@index([userId, sentenceStemId, createdAt])
}
